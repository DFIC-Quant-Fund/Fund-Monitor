name: API Health Check

on:
  schedule:
    - cron: '0 0 * * *'  # Runs once every 24 hours at midnight UTC
  workflow_dispatch:

jobs:
  health-check:
    runs-on: ubuntu-latest

    steps:
    - name: Check API Health
      run: |
        echo "Checking API health at https://api.degrootefinance.com/api/health"

        status_code=$(curl -s -o /dev/null -w "%{http_code}" https://api.degrootefinance.com/api/health)
        echo "HTTP Status Code: $status_code"

        if [ "$status_code" -ne 200 ]; then
          echo "API health check failed with HTTP status: $status_code"
          exit 1
        fi

        echo "API is healthy (HTTP 200 OK)"
